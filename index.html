<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>æ”¾ç½®ãƒã‚¤ãƒ³ãƒˆã‚²ãƒ¼ãƒ </title>
<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui;
  background:#eef1f6;
  display:flex;
  height:100vh;
}

/* ===== ã‚µã‚¤ãƒ‰ãƒãƒ¼ ===== */
aside{
  width:90px;
  background:#1e1e2f;
  display:flex;
  flex-direction:column;
  padding:10px;
  gap:10px;
}
.tabbtn{
  background:#2a2a40;
  border:none;
  color:#fff;
  border-radius:14px;
  padding:14px 8px;
  cursor:pointer;
  transition:.25s;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px;
  font-size:.75em;
}
.tabbtn span{font-size:1.4em}
.tabbtn:hover{transform:translateY(-2px);background:#3a3a5e}
.tabbtn.active{
  background:linear-gradient(135deg,#4caf50,#81c784);
  box-shadow:0 0 14px #4caf50aa;
}

/* ===== ãƒ¡ã‚¤ãƒ³ ===== */
main{
  flex:1;
  padding:20px;
  overflow:auto;
  position:relative;
}

/* ===== HUD ===== */
.hud{
  position:fixed;
  top:12px;
  right:16px;
  background:#ffffffee;
  backdrop-filter:blur(6px);
  border-radius:12px;
  padding:10px 14px;
  box-shadow:0 6px 18px #0002;
  font-size:.85em;
  z-index:100;
  animation:slide .4s ease;
}
@keyframes slide{
  from{opacity:0;transform:translateY(-10px)}
  to{opacity:1;transform:none}
}
.hud b{font-size:1.1em}

/* ===== ã‚¿ãƒ– ===== */
.tab{display:none;animation:fade .35s ease}
.tab.active{display:block}
@keyframes fade{
  from{opacity:0;transform:translateX(20px)}
  to{opacity:1;transform:none}
}

.card{
  background:#fff;
  border-radius:14px;
  padding:18px;
  margin:14px auto;
  max-width:420px;
  box-shadow:0 6px 20px #0001;
}
.pt{font-size:3em;font-weight:800;text-align:center}
.center{text-align:center}

.shopbtn{
  width:100%;
  padding:14px;
  margin:8px 0;
  border:none;
  border-radius:10px;
  background:#f1f3f9;
  cursor:pointer;
  transition:.2s;
}
.shopbtn:hover{background:#e0e5ff;transform:scale(1.02)}
.shopbtn:disabled{opacity:.4}

.small{font-size:.85em;color:#555}
.warn{color:#e53935;font-weight:700}
</style>
</head>
<body>

<!-- ===== HUD ===== -->
<div class="hud">
  ğŸ’° <b><span id="hudPt">0</span></b> pt<br>
  Lv.<span id="hudLv">1</span> /
  <span id="hudMul">1.00</span>x
</div>

<aside>
  <button class="tabbtn active" onclick="openTab('home',this)">
    <span>ğŸ </span>ãƒ›ãƒ¼ãƒ 
  </button>
  <button class="tabbtn" onclick="openTab('shop',this)">
    <span>ğŸ›’</span>ã‚·ãƒ§ãƒƒãƒ—
  </button>
  <button class="tabbtn" onclick="openTab('ach',this)">
    <span>ğŸ†</span>å®Ÿç¸¾
  </button>
</aside>

<main>
  <!-- ãƒ›ãƒ¼ãƒ  -->
  <div id="home" class="tab active">
    <div class="card">
      <div class="pt"><span id="pt">0</span> pt</div>
      <div class="center">Lv.<span id="lv">1</span></div>
      <div class="center small">
        å€ç‡ <span id="mul">1.00</span>x /
        ãƒ–ãƒ¼ã‚¹ãƒˆ <span id="boost">ãªã—</span>
      </div>
      <div id="warn" class="center warn"></div>
    </div>
  </div>

  <!-- ã‚·ãƒ§ãƒƒãƒ— -->
  <div id="shop" class="tab">
    <div class="card">
      <h3>ğŸ›’ ã‚·ãƒ§ãƒƒãƒ—</h3>
      <button class="shopbtn" onclick="buyBoost(1.5,30,10000)">
        ğŸš€ 1.5å€ï¼ˆ30ç§’ï¼‰<br>10,000pt
      </button>
      <button class="shopbtn" onclick="buyBoost(2,15,25000)">
        âš¡ 2å€ï¼ˆ15ç§’ï¼‰<br>25,000pt
      </button>
      <button class="shopbtn" onclick="buyPerm(1.2,50000)">
        â« å¸¸æ™‚+20%<br>50,000pt
      </button>
      <button class="shopbtn" onclick="buyPerm(1.5,200000)">
        ğŸ’ å¸¸æ™‚+50%<br>200,000pt
      </button>
    </div>
  </div>

  <!-- å®Ÿç¸¾ -->
  <div id="ach" class="tab">
    <div class="card">
      <h3>ğŸ† å®Ÿç¸¾</h3>
      <div id="achList"></div>
    </div>
  </div>
</main>

<script>
/* ===== DevToolsæ¤œçŸ¥ ===== */
let devtoolsOpen=false;
(() => {
  const TH=160;
  setInterval(()=>{
    const w=window.outerWidth-window.innerWidth;
    const h=window.outerHeight-window.innerHeight;
    devtoolsOpen=(w>TH||h>TH);
  },500);
})();

/* ===== ã‚¿ãƒ– ===== */
function openTab(id,btn){
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  document.querySelectorAll(".tabbtn").forEach(b=>b.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  btn.classList.add("active");
}

/* ===== DOM ===== */
const ptEl=pt;
const lvEl=lv;
const mulEl=mul;
const boostEl=boost;
const achList=document.getElementById("achList");
const hudPt=hudPt;
const hudLv=hudLv;
const hudMul=hudMul;
const warn=document.getElementById("warn");

/* ===== å®šæ•° ===== */
const BASE=100;
const K={pt:"pt",last:"last",perm:"perm",boost:"boost",until:"until",total:"total"};

/* ===== èª­è¾¼ ===== */
let point=+localStorage.getItem(K.pt)||0;
let total=+localStorage.getItem(K.total)||point;
let permMul=+localStorage.getItem(K.perm)||1;
let boostMul=+localStorage.getItem(K.boost)||1;
let boostUntil=+localStorage.getItem(K.until)||0;
let last=+localStorage.getItem(K.last)||Date.now();

/* ===== ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åŠ ç®— ===== */
point+=Math.floor((Date.now()-last)/1000)*BASE;

/* ===== ãƒ¬ãƒ™ãƒ« ===== */
const level=p=>Math.floor(Math.sqrt(p/200))+1;

/* ===== è³¼å…¥ ===== */
function buyBoost(m,s,c){
  if(point<c||Date.now()<boostUntil)return;
  point-=c;boostMul=m;boostUntil=Date.now()+s*1000;
}
function buyPerm(m,c){
  if(point<c)return;
  point-=c;permMul*=m;
}

/* ===== ãƒ«ãƒ¼ãƒ— ===== */
let prev=performance.now();
function loop(t){
  const d=(t-prev)/1000;prev=t;
  const active=Date.now()<boostUntil?boostMul:1;
  const totalMul=permMul*active;

  if(!devtoolsOpen){
    const inc=d*BASE*totalMul;
    point+=inc; total+=inc;
    warn.textContent="";
  }else{
    warn.textContent="ğŸš« DevToolsæ¤œçŸ¥ä¸­ï¼ˆåŠ ç®—åœæ­¢ï¼‰";
  }

  const p=Math.floor(point);
  const lv=level(point);

  ptEl.textContent=p;
  lvEl.textContent=lv;
  mulEl.textContent=permMul.toFixed(2);
  boostEl.textContent=active>1
    ? active+"x ("+Math.ceil((boostUntil-Date.now())/1000)+"s)"
    : "ãªã—";

  hudPt.textContent=p;
  hudLv.textContent=lv;
  hudMul.textContent=totalMul.toFixed(2);

  achList.innerHTML="";
  if(total>=10000) achList.innerHTML+="ğŸ‰ 10,000pté”æˆ<br>";
  if(permMul>=2) achList.innerHTML+="ğŸ’ å¸¸æ™‚2å€ä»¥ä¸Š<br>";

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* ===== ä¿å­˜ ===== */
setInterval(()=>{
  localStorage.setItem(K.pt,Math.floor(point));
  localStorage.setItem(K.total,Math.floor(total));
  localStorage.setItem(K.perm,permMul);
  localStorage.setItem(K.boost,boostMul);
  localStorage.setItem(K.until,boostUntil);
  localStorage.setItem(K.last,Date.now());
},5000);
</script>
</body>
</html>
